(function(e){var t=e.tmpl.complete,n=e.fn.domManip;e.tmpl.complete=function(n){var r;t(n);for(r in n)r=n[r],r.addedTmplItems&&e.inArray(r,r.addedTmplItems)===-1&&r.addedTmplItems.push(r);for(r in n)r=n[r],r.rendered&&r.rendered(r)},e.extend({tmplCmd:function(t,n,r){function o(e,t){for(var n=[],r,i,s=t.length,o,u=0,a=e.length;u<a;){o=e[u++];for(i=0;i<s;)r=t[i++],r.data===o&&n.push(r)}return n}var i=[],s;n=e.isArray(n)?n:[n];switch(t){case"find":return o(n,r);case"replace":n.reverse()}return e.each(r?o(n,r):n,function(n,o){coll=o.nodes;switch(t){case"update":o.update();break;case"remove":e(coll).remove(),r&&r.splice(e.inArray(o,r),1);break;case"replace":s=s?e(coll).insertBefore(s)[0]:e(coll).appendTo(coll[0].parentNode)[0],i.unshift(o)}}),i}}),e.fn.extend({domManip:function(t,r,i){var s=t[1],o=t[0],u;return t.length>=2&&typeof s=="object"&&!s.nodeType&&!(s instanceof e)?(u=e.makeArray(arguments),u[0]=[e.tmpl(e.template(o),s,t[2],t[3])],u[2]=function(t){e.tmpl.afterManip(this,t,i)},n.apply(this,u)):n.apply(this,arguments)}})})(jQuery);