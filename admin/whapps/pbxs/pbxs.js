winkstart.module("pbxs","pbxs",{subscribe:{"pbxs.activate":"activate","pbxs.initialized":"initialized","pbxs.module_activate":"module_activate"}},function(){var e=this;"modules"in winkstart.apps[e.__module]&&("whitelist"in winkstart.apps[e.__module].modules&&(e.modules={},$.each(winkstart.apps[e.__module].modules.whitelist,function(t,n){e.modules[n]=!1})),"blacklist"in winkstart.apps[e.__module].modules&&$.each(winkstart.apps[e.__module].modules.blacklist,function(t,n){n in e.modules&&delete e.modules[n]})),e.uninitialized_count=e._count(e.modules),e.whapp_auth(function(){winkstart.publish("whappnav.add",{name:e.__module,weight:20}),e.initialization_check()}),e.whapp_config(),winkstart.registerResources(e.__whapp,e.config.resources)},{modules:{pbxs_manager:!1},is_initialized:!1,uninitialized_count:1337,initialized:function(){var e=this;e.is_initialized=!0,winkstart.apps.pbxs["default"]&&($('[data-whapp="pbxs"] > a').addClass("activate"),e.setup_page())},activate:function(){var e=this;e.whapp_auth(function(){e.initialization_check()})},initialization_check:function(){var e=this;e.is_initialized?e.setup_page():$.each(e.modules,function(t,n){n||(e.modules[t]=!0,winkstart.module(e.__module,t).init(function(){winkstart.log(e.__module+": Initialized "+t),--e.uninitialized_count||winkstart.publish(e.__module+".initialized",{})}))})},module_activate:function(e){var t=this;t.whapp_auth(function(){winkstart.publish(e.name+".activate")})},whapp_auth:function(e){var t=this;"auth_token"in winkstart.apps[t.__module]&&winkstart.apps[t.__module].auth_token?e():winkstart.publish("auth.shared_auth",{app_name:t.__module,callback:typeof e=="function"?e:undefined})},_count:function(e){var t=0;return $.each(e,function(){t++}),t},setup_page:function(){var e=this;winkstart.publish("pbxs.module_activate",{name:"pbxs_manager"})},whapp_config:function(){var e=this;winkstart.apps.pbxs=$.extend(!0,{is_masqueradable:!0},winkstart.apps.pbxs)}});