(function(e,t,n){var r={},i={},s={},o=[].slice;e.get_version=function(e){$.ajax({url:"VERSION",cache:!1,success:function(t){t=t.replace(/[\n\s]/g,""),e(t)}})},e.publish=function(e){var n=arguments,r;if(e===!0){n=o.call(arguments,1);if(!n.length)return!1;if(n[0]in s)return!1;s[n[0]]=!0}return r=t.publish.apply(null,n),e===!0&&n[0]in s&&delete s[n[0]],r},e.subscribe=t.subscribe,e.unsubscribe=t.unsubscribe,e.templates={},e.css={},e.module=t.module,t.module.constructor=function(n,r){var i=0,s=this;this.config.templates&&(this.templates={},$.each(this.config.templates,function(t,n){i++,s.__module+"/"+n in(e.templates[s.__whapp]||{})?(i--,s.templates[t]=e.templates[s.__whapp][s.__module+"/"+n]):$.ajax({url:"whapps/"+s.__whapp+"/"+s.__module+"/"+n,cache:!1,success:function(e){i--,s.templates[t]=$(e)}})})),this.config.requires&&$.each(this.config.requires,function(n,r){e.log("Loading dependency "+n+" "+r),i++,t.module.loadModule(n,r,function(){i--})}),this.config.css&&(this.css={},$.each(this.config.css,function(t,n){s.__module+"/"+n in(e.css[s.__whapp]||{})?(s.css[t]=e.css[s.__whapp][s.__module+"/"+n],s.css[t].appendTo("head")):(n="whapps/"+s.__whapp+"/"+s.__module+"/"+n,$('<link href="'+n+'" rel="stylesheet" type="text/css">').appendTo("head"))})),this.config.subscribe&&$.each(this.config.subscribe,function(t,n){e.subscribe(t,function(){var e=!0;return s[n]&&(e=s[n].apply(s,arguments)),e})}),setTimeout(function(){i=0},3e3),function(){if(i==0){$.isFunction(r)&&r();return}var e=arguments.callee;setTimeout(function(){e()},10)}()},e.module.loadApp("core",function(){this.init()})})(window.winkstart=window.winkstart||{},window.amplify=window.amplify||{});